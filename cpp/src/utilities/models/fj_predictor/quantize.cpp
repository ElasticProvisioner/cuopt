
/*
 * SPDX-FileCopyrightText: Copyright (c) 2025-2026, NVIDIA CORPORATION & AFFILIATES. All rights
 * reserved. SPDX-License-Identifier: Apache-2.0
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */

#include "header.h"

static const double threshold[] = {
  0.054247050000000012,
  0.077229550000000022,
  0.099138400000000002,
  0.12088200000000002,
  0.14051650000000002,
  0.15852850000000004,
  0.17679700000000004,
  0.19352650000000002,
  0.21021800000000002,
  0.22558550000000002,
  0.24112700000000004,
  0.25703600000000004,
  0.27504900000000004,
  0.29268150000000009,
  0.31128750000000005,
  0.33090700000000001,
  0.34973950000000004,
  0.36837650000000005,
  0.38755100000000003,
  0.40692750000000005,
  0.42464700000000005,
  0.44212900000000005,
  0.46115050000000007,
  0.47875750000000006,
  0.49512500000000004,
  0.51183000000000012,
  0.52816850000000015,
  0.54488850000000011,
  0.56229750000000012,
  0.57881900000000008,
  0.59550200000000009,
  0.61214950000000012,
  0.62885000000000013,
  0.64696700000000018,
  0.66350950000000009,
  0.67997150000000006,
  0.69847550000000014,
  0.7159675000000002,
  0.73463250000000013,
  0.7525940000000001,
  0.77200500000000016,
  0.79034150000000014,
  0.80839950000000005,
  0.82770850000000007,
  0.8455950000000001,
  0.86400500000000013,
  0.88264050000000005,
  0.9004295000000001,
  0.91857200000000006,
  0.93668050000000014,
  0.95404050000000018,
  0.97391950000000016,
  0.99200750000000004,
  1.0099000000000002,
  1.0289150000000002,
  1.0465600000000002,
  1.0646550000000004,
  1.08342,
  1.1014450000000002,
  1.1397000000000002,
  1.1587800000000004,
  1.1770050000000001,
  1.1970650000000003,
  1.2149600000000003,
  1.2334100000000003,
  1.2509550000000003,
  1.2698400000000001,
  1.2892250000000003,
  1.3068250000000001,
  1.3257700000000001,
  1.3439900000000002,
  1.3627650000000002,
  1.3818950000000003,
  1.3997500000000003,
  1.4181450000000002,
  1.4367350000000003,
  1.4547850000000002,
  1.472415,
  1.4914700000000003,
  1.5101100000000003,
  1.5280200000000004,
  1.5462100000000001,
  1.5645300000000002,
  1.5825350000000002,
  1.6018750000000004,
  1.6398350000000002,
  1.6586050000000003,
  1.6957200000000003,
  1.7142950000000001,
  1.7329100000000002,
  1.7519050000000003,
  1.7889300000000004,
  1.8084400000000003,
  1.84535,
  1.8819950000000003,
  1.9005400000000001,
  1.9191650000000002,
  1.9559750000000002,
  1.9729050000000001,
  1.9908450000000002,
  2.0093400000000003,
  2.0269500000000007,
  2.0634850000000005,
  2.0812900000000005,
  2.0995600000000008,
  2.1174250000000003,
  2.1351400000000003,
  2.1524100000000006,
  2.1703750000000004,
  2.1880300000000004,
  2.2057200000000008,
  2.2244050000000004,
  2.2413600000000007,
  2.2589850000000005,
  2.2762350000000002,
  2.2941550000000004,
  2.3126850000000005,
  2.3300800000000002,
  2.3486300000000004,
  2.3668800000000005,
  2.3849800000000001,
  2.4039000000000006,
  2.4207550000000002,
  2.4380750000000004,
  2.4563950000000006,
  2.4738150000000005,
  2.4917700000000003,
  2.5087150000000005,
  2.5256750000000001,
  2.541865,
  2.5750850000000001,
  2.5926700000000005,
  2.6103800000000006,
  2.6462700000000008,
  2.6646600000000005,
  2.6821750000000004,
  2.6995250000000008,
  2.7161250000000003,
  2.7339100000000003,
  2.7519550000000002,
  2.7684900000000003,
  2.7861950000000006,
  2.8210050000000004,
  2.8391800000000003,
  2.8555100000000002,
  2.8724000000000003,
  2.8905950000000007,
  2.9086600000000007,
  2.9273950000000002,
  2.9445150000000004,
  2.9631150000000006,
  2.9813800000000006,
  3.0161400000000005,
  3.0351250000000003,
  3.0535200000000002,
  3.0715450000000004,
  3.0891000000000006,
  3.1077850000000002,
  3.1259600000000005,
  3.1445250000000002,
  3.1638600000000001,
  3.2029950000000005,
  3.2231000000000005,
  3.2427850000000005,
  3.2622000000000004,
  3.2821500000000001,
  3.3022150000000008,
  3.3210900000000003,
  3.3419400000000006,
  3.3625650000000005,
  3.3821600000000003,
  3.4255600000000004,
  3.4476550000000006,
  3.4694350000000003,
  3.4931250000000005,
  3.5172500000000002,
  3.5405750000000005,
  3.5633350000000004,
  3.5881150000000006,
  3.6123700000000007,
  3.6388050000000005,
  3.6645250000000007,
  3.6929500000000002,
  3.7206100000000002,
  3.7487850000000003,
  3.8103150000000006,
  3.8410400000000005,
  3.8753900000000003,
  3.9096100000000003,
  3.9434900000000002,
  3.9779100000000001,
  4.0157400000000001,
  4.0538750000000006,
  4.0947550000000001,
  4.134875000000001,
  4.1789850000000008,
  4.2277500000000012,
  4.2804200000000003,
  4.3315450000000011,
  4.3857550000000005,
  4.4510850000000008,
  4.5179800000000006,
  4.5945550000000006,
  4.6744550000000009,
  4.7680650000000009,
  4.8691100000000009,
  4.9748750000000008,
  5.1040400000000004,
  5.2357750000000012,
  5.3817050000000011,
  5.5487400000000013,
  5.7226800000000013,
  5.9013650000000011,
  6.0933350000000006,
  6.2959750000000012,
  6.5019050000000016,
  6.7376150000000008,
  6.9850100000000008,
  7.2452850000000009,
  7.5387250000000003,
  7.8497500000000011,
  8.206685000000002,
  8.5881250000000016,
  9.0114350000000005,
  9.5016150000000028,
  10.006050000000002,
  10.534950000000002,
  11.213450000000003,
  12.138300000000003,
  13.343550000000002,
  14.829750000000002,
  16.520350000000004,
  19.149450000000005,
  22.676800000000004,
  27.456400000000002,
  34.351750000000003,
  47.268800000000006,
  1.0000000180025095e-35,
  1.5000000000000002,
  2.5000000000000004,
  3.5000000000000004,
  4.5000000000000009,
  7.5000000000000009,
  9.5000000000000018,
  13.500000000000002,
  20.500000000000004,
  27.500000000000004,
  32.500000000000007,
  35.500000000000007,
  73.500000000000014,
  145.50000000000003,
  210.50000000000003,
  256.50000000000006,
  267.50000000000006,
  271.50000000000006,
  338.50000000000006,
  416.50000000000006,
  627.50000000000011,
  646.50000000000011,
  654.50000000000011,
  728.50000000000011,
  785.50000000000011,
  917.50000000000011,
  943.50000000000011,
  1105.5000000000002,
  1168.5000000000002,
  1414.5000000000002,
  1511.5000000000002,
  1766.5000000000002,
  2142.5000000000005,
  2424.5000000000005,
  2476.5000000000005,
  2824.5000000000005,
  3182.5000000000005,
  3233.5000000000005,
  3334.5000000000005,
  3428.5000000000005,
  3734.5000000000005,
  3862.0000000000005,
  4068.5000000000005,
  4221.5000000000009,
  4296.5000000000009,
  4701.5000000000009,
  4781.5000000000009,
  6990.5000000000009,
  7213.5000000000009,
  7449.5000000000009,
  8540.5000000000018,
  9118.5000000000018,
  9521.5000000000018,
  10539.500000000002,
  11717.500000000002,
  12095.500000000002,
  13029.500000000002,
  14400.000000000002,
  14615.500000000002,
  15096.500000000002,
  15817.500000000002,
  16830.500000000004,
  17346.500000000004,
  20007.000000000004,
  20988.500000000004,
  21532.500000000004,
  23313.500000000004,
  24562.500000000004,
  30402.000000000004,
  35983.500000000007,
  40040.000000000007,
  41987.500000000007,
  43540.000000000007,
  44215.500000000007,
  45601.500000000007,
  47232.500000000007,
  54221.000000000007,
  68471.500000000015,
  74712.500000000015,
  89913.000000000015,
  125519.00000000001,
  149049.00000000003,
  230573.00000000003,
  3.5000000000000004,
  4.5000000000000009,
  5.5000000000000009,
  6.5000000000000009,
  7.5000000000000009,
  8.5000000000000018,
  11.500000000000002,
  13.500000000000002,
  14.500000000000002,
  15.500000000000002,
  17.500000000000004,
  24.500000000000004,
  29.500000000000004,
  30.500000000000004,
  31.500000000000004,
  33.500000000000007,
  35.500000000000007,
  37.500000000000007,
  40.500000000000007,
  41.500000000000007,
  42.500000000000007,
  43.500000000000007,
  45.500000000000007,
  49.500000000000007,
  50.500000000000007,
  55.500000000000007,
  59.500000000000007,
  60.500000000000007,
  65.500000000000014,
  68.000000000000014,
  71.000000000000014,
  72.500000000000014,
  73.500000000000014,
  74.500000000000014,
  80.500000000000014,
  90.000000000000014,
  96.500000000000014,
  98.500000000000014,
  99.500000000000014,
  105.50000000000001,
  108.50000000000001,
  112.50000000000001,
  113.50000000000001,
  116.50000000000001,
  117.50000000000001,
  118.50000000000001,
  121.50000000000001,
  124.50000000000001,
  127.00000000000001,
  156.50000000000003,
  158.50000000000003,
  174.50000000000003,
  182.00000000000003,
  186.50000000000003,
  190.50000000000003,
  193.00000000000003,
  197.50000000000003,
  215.50000000000003,
  230.50000000000003,
  238.50000000000003,
  242.50000000000003,
  274.50000000000006,
  287.50000000000006,
  310.00000000000006,
  317.00000000000006,
  475.50000000000006,
  478.00000000000006,
  501.50000000000006,
  508.00000000000006,
  558.00000000000011,
  586.50000000000011,
  594.50000000000011,
  644.50000000000011,
  665.50000000000011,
  686.00000000000011,
  829.00000000000011,
  933.00000000000011,
  973.00000000000011,
  1000.5000000000001,
  1023.0000000000001,
  1101.5000000000002,
  1594.0000000000002,
  1773.5000000000002,
  1868.0000000000002,
  1935.0000000000002,
  2075.5000000000005,
  2658.5000000000005,
  2842.0000000000005,
  2928.0000000000005,
  3159.0000000000005,
  3844.0000000000005,
  3959.0000000000005,
  5956.0000000000009,
  6744.5000000000009,
  7399.5000000000009,
  8990.0000000000018,
  9523.5000000000018,
  11378.500000000002,
  12174.500000000002,
  15191.500000000002,
  18400.500000000004,
  20392.500000000004,
  21043.500000000004,
  21811.000000000004,
  30397.000000000004,
  30926.500000000004,
  33002.500000000007,
  48554.500000000007,
  56727.500000000007,
  77009.500000000015,
  97457.000000000015,
  117653.00000000001,
  137723.50000000003,
  145615.50000000003,
  1.0000000180025095e-35,
  19.000000000000004,
  31.000000000000004,
  55.500000000000007,
  69.500000000000014,
  70.500000000000014,
  99.000000000000014,
  119.00000000000001,
  176.50000000000003,
  189.50000000000003,
  196.00000000000003,
  201.00000000000003,
  219.00000000000003,
  263.00000000000006,
  290.00000000000006,
  306.00000000000006,
  317.50000000000006,
  361.50000000000006,
  384.00000000000006,
  417.00000000000006,
  448.50000000000006,
  534.50000000000011,
  593.50000000000011,
  622.50000000000011,
  693.50000000000011,
  889.50000000000011,
  927.50000000000011,
  1116.5000000000002,
  1455.5000000000002,
  1498.0000000000002,
  1995.5000000000002,
  2027.5000000000002,
  2105.5000000000005,
  2463.5000000000005,
  2518.5000000000005,
  2595.5000000000005,
  2630.0000000000005,
  3336.0000000000005,
  4222.5000000000009,
  4319.5000000000009,
  4543.5000000000009,
  5196.5000000000009,
  5211.0000000000009,
  5279.0000000000009,
  5647.0000000000009,
  6426.5000000000009,
  6471.5000000000009,
  6781.5000000000009,
  7008.0000000000009,
  7273.0000000000009,
  8219.0000000000018,
  8313.0000000000018,
  8346.0000000000018,
  8890.5000000000018,
  9579.5000000000018,
  10096.000000000002,
  10296.500000000002,
  10412.000000000002,
  10570.000000000002,
  10722.500000000002,
  11284.000000000002,
  11482.000000000002,
  12403.500000000002,
  13743.000000000002,
  16623.500000000004,
  17719.000000000004,
  20045.500000000004,
  22896.000000000004,
  24893.000000000004,
  29297.500000000004,
  32360.500000000004,
  32826.000000000007,
  42917.000000000007,
  45655.500000000007,
  49866.500000000007,
  55546.000000000007,
  57005.000000000007,
  60339.000000000007,
  70968.500000000015,
  77454.500000000015,
  86012.000000000015,
  86932.000000000015,
  88579.000000000015,
  98965.000000000015,
  127333.50000000001,
  169734.00000000003,
  233398.00000000003,
  320960.50000000006,
  341815.50000000006,
  1315285.0000000002,
  2747995.0000000005,
  10.500000000000002,
  16.500000000000004,
  38.000000000000007,
  42.500000000000007,
  61.500000000000007,
  76.500000000000014,
  101.50000000000001,
  300.50000000000006,
  464.00000000000006,
  578.50000000000011,
  640.00000000000011,
  653.50000000000011,
  721.00000000000011,
  849.00000000000011,
  1140.0000000000002,
  1197.0000000000002,
  1359.0000000000002,
  1627.5000000000002,
  1925.0000000000002,
  2298.5000000000005,
  2356.0000000000005,
  2394.5000000000005,
  2529.0000000000005,
  3626.5000000000005,
  4099.0000000000009,
  5157.0000000000009,
  5521.5000000000009,
  7489.0000000000009,
  8797.5000000000018,
  9813.0000000000018,
  11172.500000000002,
  11823.000000000002,
  12490.500000000002,
  12827.000000000002,
  13934.000000000002,
  14718.000000000002,
  14944.500000000002,
  15924.500000000002,
  16641.500000000004,
  17124.000000000004,
  17409.000000000004,
  17805.000000000004,
  18541.500000000004,
  20890.500000000004,
  22641.000000000004,
  23763.500000000004,
  27226.000000000004,
  28849.000000000004,
  34014.000000000007,
  39933.000000000007,
  48730.000000000007,
  55362.000000000007,
  58384.000000000007,
  91637.500000000015,
  97665.000000000015,
  108046.50000000001,
  111482.00000000001,
  127740.00000000001,
  141620.50000000003,
  146171.50000000003,
  164305.50000000003,
  167857.50000000003,
  206722.00000000003,
  215085.50000000003,
  271255.50000000006,
  364916.50000000006,
  376899.50000000006,
  446870.00000000006,
  504658.00000000006,
  534428.50000000012,
  2917540.0000000005,
  8.0000000000000018,
  40.500000000000007,
  69.500000000000014,
  76.000000000000014,
  99.000000000000014,
  102.50000000000001,
  116.50000000000001,
  128.50000000000003,
  147.50000000000003,
  161.00000000000003,
  190.50000000000003,
  201.00000000000003,
  218.00000000000003,
  246.00000000000003,
  301.50000000000006,
  306.50000000000006,
  411.00000000000006,
  448.50000000000006,
  490.50000000000006,
  739.00000000000011,
  786.50000000000011,
  835.00000000000011,
  1435.5000000000002,
  1490.0000000000002,
  1585.0000000000002,
  1947.5000000000002,
  2089.5000000000005,
  2208.0000000000005,
  2262.0000000000005,
  2504.0000000000005,
  2595.5000000000005,
  2694.0000000000005,
  3290.5000000000005,
  3486.0000000000005,
  5199.5000000000009,
  5448.5000000000009,
  7246.0000000000009,
  8305.0000000000018,
  8345.5000000000018,
  8884.0000000000018,
  11484.500000000002,
  12542.000000000002,
  13993.500000000002,
  14321.000000000002,
  14486.500000000002,
  29297.500000000004,
  41026.500000000007,
  45655.500000000007,
  57005.000000000007,
  62415.500000000007,
  69861.000000000015,
  77483.500000000015,
  82860.500000000015,
  86012.000000000015,
  105975.50000000001,
  122661.50000000001,
  135210.50000000003,
  154808.00000000003,
  165244.00000000003,
  195544.50000000003,
  321530.50000000006,
  341815.50000000006,
  14.500000000000002,
  66.500000000000014,
  242.50000000000003,
  265.50000000000006,
  306.50000000000006,
  341.50000000000006,
  518.00000000000011,
  730.50000000000011,
  758.50000000000011,
  896.50000000000011,
  982.50000000000011,
  1007.5000000000001,
  1108.0000000000002,
  1133.5000000000002,
  1178.0000000000002,
  1436.0000000000002,
  1599.5000000000002,
  1916.5000000000002,
  2036.0000000000002,
  2066.5000000000005,
  2456.0000000000005,
  2816.0000000000005,
  2849.0000000000005,
  3190.5000000000005,
  3226.5000000000005,
  3564.0000000000005,
  3726.5000000000005,
  4004.5000000000005,
  4719.5000000000009,
  5175.0000000000009,
  5663.0000000000009,
  5848.0000000000009,
  7347.5000000000009,
  8946.0000000000018,
  10887.500000000002,
  11141.500000000002,
  12386.000000000002,
  12893.000000000002,
  12981.000000000002,
  13236.000000000002,
  13742.500000000002,
  13874.000000000002,
  14396.000000000002,
  14769.500000000002,
  16616.000000000004,
  17772.500000000004,
  18503.000000000004,
  18928.000000000004,
  19963.500000000004,
  22431.000000000004,
  22656.000000000004,
  23089.500000000004,
  25009.500000000004,
  25158.500000000004,
  29801.500000000004,
  30930.500000000004,
  32941.500000000007,
  33925.000000000007,
  35517.000000000007,
  35966.500000000007,
  37351.500000000007,
  38399.000000000007,
  40769.000000000007,
  42352.500000000007,
  43749.000000000007,
  45226.000000000007,
  46621.500000000007,
  57435.500000000007,
  58829.500000000007,
  60692.000000000007,
  62587.500000000007,
  64024.000000000007,
  67166.000000000015,
  72662.000000000015,
  73712.500000000015,
  74556.500000000015,
  78614.500000000015,
  83046.500000000015,
  98968.000000000015,
  102883.00000000001,
  124003.00000000001,
  131103.50000000003,
  135356.50000000003,
  145271.00000000003,
  167192.00000000003,
  172253.00000000003,
  198236.00000000003,
  209702.50000000003,
  298248.50000000006,
  333792.50000000006,
  343878.50000000006,
  404776.00000000006,
  460381.00000000006,
  628991.00000000012,
  83.500000000000014,
  183.50000000000003,
  468.00000000000006,
  1396.0000000000002,
  2433.0000000000005,
  3465.0000000000005,
  3645.5000000000005,
  5270.0000000000009,
  6121.5000000000009,
  6510.5000000000009,
  7307.0000000000009,
  8358.5000000000018,
  8618.5000000000018,
  8828.5000000000018,
  9135.0000000000018,
  13322.500000000002,
  14156.000000000002,
  14773.000000000002,
  18059.000000000004,
  19199.000000000004,
  20030.000000000004,
  21288.500000000004,
  22830.500000000004,
  39487.500000000007,
  51294.500000000007,
  55184.000000000007,
  58766.500000000007,
  78090.000000000015,
  79203.500000000015,
  85545.500000000015,
  86497.500000000015,
  96575.500000000015,
  101879.50000000001,
  104890.50000000001,
  106509.00000000001,
  111473.00000000001,
  133804.50000000003,
  143238.00000000003,
  152266.50000000003,
  188714.00000000003,
  193144.50000000003,
  201859.00000000003,
  204145.00000000003,
  211177.00000000003,
  216282.00000000003,
  227905.50000000003,
  233158.50000000003,
  242732.00000000003,
  247534.50000000003,
  252735.00000000003,
  263001.50000000006,
  267680.00000000006,
  286053.50000000006,
  301277.50000000006,
  316160.00000000006,
  326485.50000000006,
  341223.00000000006,
  382538.50000000006,
  397214.50000000006,
  420753.50000000006,
  427014.00000000006,
  474030.00000000006,
  484374.50000000006,
  490157.50000000006,
  493561.50000000006,
  517275.50000000006,
  525159.50000000012,
  536338.50000000012,
  555454.50000000012,
  577752.00000000012,
  616908.00000000012,
  643671.50000000012,
  665158.00000000012,
  688029.50000000012,
  748092.00000000012,
  791728.50000000012,
  805917.00000000012,
  833331.00000000012,
  846131.50000000012,
  889587.00000000012,
  925745.00000000012,
  960960.50000000012,
  993471.50000000012,
  1000860.0000000001,
  1033940.0000000001,
  1088030.0000000002,
  1104190.0000000002,
  1141090.0000000002,
  1227215.0000000002,
  1302410.0000000002,
  1327790.0000000002,
  1565560.0000000002,
  1713120.0000000002,
  1986515.0000000002,
  2295955.0000000005,
  2459445.0000000005,
  2786970.0000000005,
  4311770.0000000009,
  4897840.0000000009,
  7675510.0000000009,
  12103450.000000002,
  1.0000000180025095e-35,
  0.025444000000000005,
  0.079041650000000005,
  0.47263850000000002,
  0.51316300000000015,
  0.61466950000000009,
  0.70002100000000012,
  0.84333400000000014,
  1.0452850000000002,
  1.2015150000000003,
  1.4797750000000003,
  1.8327900000000001,
  2.2462950000000004,
  2.4300000000000006,
  2.5927000000000002,
  2.6670150000000006,
  2.8069300000000004,
  3.1766550000000007,
  3.2475100000000006,
  3.3747950000000002,
  3.4595750000000005,
  3.6730550000000002,
  3.8561550000000007,
  4.4209650000000007,
  4.6392950000000015,
  4.865940000000001,
  4.9636350000000009,
  5.1358750000000013,
  5.5377350000000005,
  5.745820000000001,
  5.9460500000000005,
  6.3433350000000006,
  6.3778100000000011,
  6.5389250000000008,
  6.6173200000000012,
  7.1363800000000017,
  7.4741750000000016,
  7.6210850000000008,
  8.6734450000000027,
  9.4143250000000016,
  11.746350000000001,
  12.052000000000001,
  12.250050000000002,
  13.267300000000001,
  17.041250000000002,
  17.986650000000001,
  21.122200000000003,
  21.844500000000004,
  23.696150000000006,
  25.750650000000004,
  26.183450000000004,
  27.539350000000002,
  31.875650000000004,
  36.846500000000006,
  38.188850000000009,
  44.081200000000003,
  52.333200000000005,
  54.716150000000006,
  60.769450000000006,
  65.705850000000012,
  85.315750000000023,
  108.21300000000001,
  122.06700000000002,
  150.02500000000001,
  157.58100000000002,
  167.36850000000001,
  180.69350000000003,
  206.27400000000003,
  282.04500000000002,
  301.06900000000002,
  431.21800000000002,
  513.42400000000009,
  780.49650000000008,
  813.8660000000001,
  850.00950000000012,
  1134.5900000000004,
  1346.6950000000002,
  2370.7800000000002,
  2928.5150000000008,
  1.3466250000000002e-05,
  2.2664350000000006e-05,
  2.9555800000000003e-05,
  3.5335850000000012e-05,
  3.6073500000000006e-05,
  3.9458500000000002e-05,
  4.3825250000000005e-05,
  5.8516e-05,
  6.4233050000000024e-05,
  7.0834150000000017e-05,
  8.9559350000000012e-05,
  9.5430800000000015e-05,
  0.00011455550000000001,
  0.00012689600000000001,
  0.00014240450000000004,
  0.00016513700000000001,
  0.00018171050000000003,
  0.00018756350000000003,
  0.00020882050000000003,
  0.00021563800000000001,
  0.00022961900000000003,
  0.00026418050000000004,
  0.00027278350000000008,
  0.00029956750000000005,
  0.00032692350000000002,
  0.00033880400000000006,
  0.00035918650000000006,
  0.00038193300000000004,
  0.00042447950000000008,
  0.00043747650000000002,
  0.00044906850000000007,
  0.00049152850000000004,
  0.00052591450000000011,
  0.00057647100000000017,
  0.00058207650000000012,
  0.00098674500000000003,
  0.0011041950000000003,
  0.0012247250000000001,
  0.0012767100000000001,
  0.0013355900000000002,
  0.001509605,
  0.0017419350000000002,
  0.0018100400000000004,
  0.0018508650000000004,
  0.0021851550000000007,
  0.0024035350000000005,
  0.00336228,
  0.0038408950000000004,
  0.004200225000000001,
  0.0047036750000000009,
  0.0051918100000000007,
  0.0055236550000000014,
  0.0057092000000000002,
  0.0059764100000000006,
  0.0069381250000000007,
  0.0073699550000000009,
  0.007565500000000001,
  0.0084957950000000022,
  0.0089344600000000017,
  0.0099261550000000007,
  0.014203600000000002,
  0.021387700000000006,
  0.023916750000000004,
  0.026089700000000004,
  0.05008255000000001,
  0.055832150000000004,
  0.060545100000000004,
  0.070805450000000006,
  0.087852150000000004,
  0.11160100000000002,
  0.12906450000000003,
  0.18728800000000004,
  0.22001300000000004,
  0.25453400000000004,
  0.26550900000000005,
  0.31291300000000005,
  0.35104150000000006,
  0.41306200000000004,
  0.57042700000000013,
  0.64485350000000008,
  0.96875000000000011,
  1.0000000180025095e-35,
  0.0039979100000000012,
  0.0082457700000000012,
  0.038986650000000005,
  0.054666050000000001,
  0.070373600000000022,
  0.097335900000000017,
  0.19564850000000003,
  0.20630450000000003,
  0.24236000000000002,
  0.25417800000000007,
  0.25770150000000008,
  0.27507600000000004,
  0.28204950000000006,
  0.28742100000000009,
  0.29918200000000006,
  0.30476150000000007,
  0.33851400000000004,
  0.37035050000000008,
  0.38581450000000006,
  0.44627100000000003,
  0.45825600000000005,
  0.4758035000000001,
  0.52170800000000017,
  0.54062450000000017,
  0.54514950000000006,
  0.57222350000000011,
  0.67992200000000003,
  0.70028650000000014,
  0.75992800000000005,
  0.81040200000000018,
  0.85826700000000011,
  0.95305950000000006,
  0.98670650000000015,
  1.0208650000000001,
  1.0782450000000001,
  1.1067700000000003,
  1.1631450000000003,
  1.2699600000000004,
  1.2872250000000001,
  1.2987750000000002,
  1.3993100000000003,
  1.5141650000000002,
  1.5734200000000003,
  1.6142300000000003,
  1.6834550000000001,
  1.8165200000000001,
  1.9725750000000002,
  2.0513250000000007,
  2.0544200000000008,
  2.1066100000000003,
  2.2829500000000005,
  2.3961550000000003,
  2.6080850000000004,
  2.7410500000000004,
  3.0611950000000001,
  3.5134100000000008,
  3.5836800000000006,
  4.7010550000000011,
  4.7679900000000011,
  5.106815000000001,
  5.1937250000000015,
  5.2231500000000013,
  5.349705000000001,
  5.4792200000000006,
  5.6649900000000004,
  5.8800200000000009,
  6.6231050000000007,
  6.9449300000000003,
  7.3326800000000008,
  8.199600000000002,
  11.794000000000002,
  16.289250000000003,
  19.559350000000006,
  24.766300000000005,
  1.0000000180025095e-35,
};

static const int th_begin[] = {
  0,
  237,
  320,
  434,
  525,
  596,
  658,
  752,
  853,
  932,
  1013,
  1088,
};

static const int th_len[] = {
  237,
  83,
  114,
  91,
  71,
  62,
  94,
  101,
  79,
  81,
  75,
  1,
};

/*
 * \brief Function to convert a feature value into bin index.
 * \param val Feature value, in floating-point
 * \param fid Feature identifier
 * \return bin Index corresponding to given feature value
 */
int fj_predictor::quantize(double val, unsigned fid)
{
  const size_t offset = th_begin[fid];
  const double* array = &threshold[offset];
  int len             = th_len[fid];
  int low             = 0;
  int high            = len;
  int mid;
  double mval;
  // It is possible th_begin[i] == [total_num_threshold]. This means that
  // all features i, (i+1), ... are not used for any of the splits in the model.
  // So in this case, just return something
  if (offset == 1089 || val < array[0]) { return -10; }
  while (low + 1 < high) {
    mid  = (low + high) / 2;
    mval = array[mid];
    if (val == mval) {
      return mid * 2;
    } else if (val < mval) {
      high = mid;
    } else {
      low = mid;
    }
  }
  if (array[low] == val) {
    return low * 2;
  } else if (high == len) {
    return len * 2;
  } else {
    return low * 2 + 1;
  }
}
